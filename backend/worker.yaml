runtime: nodejs22
service: epub-worker
instance_class: F2

# 基本縮放設定 - Worker 使用基本縮放
basic_scaling:
  max_instances: 3
  idle_timeout: 10m

# 網路設定 - Worker 不需要 HTTP 伺服器
network:
  instance_ip_mode: external

# 環境變數
env_variables:
  NODE_ENV: production
  APP_MODE: worker

# 資源限制 - Worker 需要更多記憶體和 CPU
resources:
  cpu: 1
  memory_gb: 1
  disk_size_gb: 10

# 不需要的檔案
skip_files:
  - ^(.*/)?#.*#$
  - ^(.*/)?.*~$
  - ^(.*/)?.*\.py[co]$
  - ^(.*/)?.*/RCS/.*$
  - ^(.*/)?\..*$
  - ^(.*/)?tests$
  - ^(.*/)?test$
  - ^(.*/)?node_modules$
  - ^(.*/)?coverage$
  - ^(.*/)?src$
  - ^(.*/)?tsconfig.*\.json$
  - ^(.*/)?.*\.md$
  - ^(.*/)?.*\.ts$
  - ^(.*/)?Dockerfile$
  - ^(.*/)?docker-compose.*\.yml$
  - ^(.*/)?\.docker.*$
  - frontend/
# Worker 使用基本縮放而非自動縮放
# 因為 Worker 不是 HTTP 應用程式
